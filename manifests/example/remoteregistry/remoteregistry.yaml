---
apiVersion: v1
kind: Service
metadata:
  name: shared-services-registry
  namespace: cross-cluster-connectivity
spec:
  ports:
  - port: 443
    protocol: TCP
---
apiVersion: v1
kind: Endpoints
metadata:
  name: shared-services-registry
  namespace: cross-cluster-connectivity
subsets:
  - addresses:
    # Remote registry IP address. Usually the Node IP(s) of the clusters you
    # are connecting to. By default, the connectivity-registry is exposed as a
    # NodePort service.
    - ip: REMOTE_REGISTRY_IP
    ports:
    # By default, the connectivity-registry exposes a NodePort service on port
    # 30001.
    - port: 30001
---
apiVersion: connectivity.tanzu.vmware.com/v1alpha1
kind: RemoteRegistry
metadata:
  name: shared-services-registry
  namespace: cross-cluster-connectivity
spec:
  # In-cluster dns name of the service created up above
  address: "shared-services-registry.cross-cluster-connectivity.svc.cluster.local:443"
  tlsConfig:
    # Base64 encoded CA certificate of the remote registry
    serverCA: REGISTRY_CA_CERTIFICATE
    # Server name of the remote registry i.e the common name within the
    # certificate of the remote registry
    serverName: "REGISTRY_DOMAIN"
    # List of strings specifying domains (and their subdomains) that are
    # allowed to be imported as ServiceRecords by the connectivity-registry.
    #
    # By default, this list is empty, which means all domains are allowed
    # to be imported.
    #
    # Domains in the list must follow the standard requirements for DNS names
    # such as those listed in RFC-1123, Section 2.
    # This means the name must:
    # - contain no more than 255 characters
    # - contain labels of at most 63 characters
    # - contain only alphanumeric characters, '-' or '.'. If the domain name
    #   uses special Unicode characters, then it should be in Punycode
    #   representation.
    # - start with an alphanumeric character
    # - end with an alphanumeric character
    # - not contain an all-numeric TLD
    #
    # The following example will allow ServiceRecords with FQDNs such as
    # 'nginx.xcc.test' or 'xcc.test'.
    #
    # allowedDomains: ['xcc.test']
    allowedDomains: []
